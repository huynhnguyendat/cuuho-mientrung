<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cá»©u Há»™ Miá»n Trung</title>

  <!-- ThÆ° viá»‡n báº£n Ä‘á»“ miá»…n phÃ­ Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }
    header {
      background: #0077b6;
      color: #fff;
      text-align: center;
      padding: 12px;
      font-size: 20px;
      font-weight: bold;
    }
    #map {
      height: 70vh;
      width: 100%;
    }
    .form-container {
      text-align: center;
      padding: 10px;
      background: #fff;
    }
    input {
      padding: 8px;
      margin: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      background: #0077b6;
      border: none;
      color: white;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #005f87;
    }
    #status {
      color: #222;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <header>ğŸ†˜ Cá»¨U Há»˜ MIá»€N TRUNG</header>

  <div id="map"></div>

  <div class="form-container">
    <h3>ÄÄƒng kÃ½ / ÄÄƒng nháº­p</h3>
    <input type="email" id="email" placeholder="Nháº­p email" />
    <input type="password" id="password" placeholder="Nháº­p máº­t kháº©u" />
    <br />
    <button id="signup">ÄÄƒng kÃ½</button>
    <button id="login">ÄÄƒng nháº­p</button>
    <p id="status"></p>
  </div>

  <!-- Firebase vÃ  logic xá»­ lÃ½ -->
  <script type="module">
 <!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cá»©u Há»™ Miá»n Trung â€” Cáº­p nháº­t tÃ¬nh hÃ¬nh</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    :root{
      --blue:#0b74de;--danger:#d32f2f;--orange:#f97316;--yellow:#f59e0b;--green:#16a34a;
      --card:#fff;--muted:#5b6b72;
    }
    body{font-family:Arial,Helvetica,sans-serif;background:#eef6fb;margin:0;color:#06202a}
    header{background:linear-gradient(90deg,#084b58,#0b7a8b);color:white;padding:18px;text-align:center;font-size:20px}
    .wrap{max-width:1000px;margin:18px auto;padding:12px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
    @media (max-width:960px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border-radius:10px;padding:12px;box-shadow:0 6px 20px rgba(6,32,38,0.06)}
    .small{font-size:13px;color:var(--muted)}
    #map{height:300px;border-radius:8px;overflow:hidden;background:#dff3fa;display:flex;align-items:center;justify-content:center}
    input,select,textarea{width:100%;padding:10px;margin:6px 0;border-radius:8px;border:1px solid #d1e9f0}
    button{padding:10px 12px;border-radius:8px;border:0;cursor:pointer}
    .btn-primary{background:var(--blue);color:white}
    .btn-danger{background:var(--danger);color:white}
    .post{border-left:6px solid #eee;padding:10px;margin-bottom:10px;border-radius:6px;background:#fbffff}
    .badge{display:inline-block;padding:6px 8px;border-radius:6px;color:white;font-weight:600}
    .badge.red{background:var(--danger)} .badge.orange{background:var(--orange)} .badge.yellow{background:var(--yellow)} .badge.green{background:var(--green)}
    .admin-actions{margin-top:8px}
    .media{max-width:100%;border-radius:6px;margin-top:8px}
    .info-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  </style>
</head>
<body>
  <header>ğŸŒŠ Cá»¨U Há»˜ MIá»€N TRUNG â€” Cáº­p nháº­t & Cá»©u há»™</header>

  <div class="wrap">
    <div class="grid">
      <!-- LEFT: main -->
      <div>
        <div class="card">
          <h3>ğŸ“ Báº£n Ä‘á»“ (demo)</h3>
          <div id="map">Báº£n Ä‘á»“ sáº½ hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y</div>
          <p class="small">Báº£n Ä‘á»“ dÃ¹ng OpenStreetMap (Leaflet). Sau nÃ y cÃ³ thá»ƒ hiá»ƒn thá»‹ marker cÃ¡c bÃ i Ä‘Äƒng lÃªn map.</p>
        </div>

        <div class="card" style="margin-top:12px;">
          <h3>ğŸ“£ Báº£ng tin cá»™ng Ä‘á»“ng (cÃ´ng khai)</h3>
          <div id="postsList" class="small"></div>
        </div>
      </div>

      <!-- RIGHT: auth + post form -->
      <aside>
        <div class="card">
          <h4>ğŸ” ÄÄƒng kÃ½ / ÄÄƒng nháº­p</h4>
          <div id="authArea">
            <input id="email" type="email" placeholder="Email" />
            <input id="password" type="password" placeholder="Máº­t kháº©u (>=6 kÃ½ tá»±)" />
            <div style="display:flex;gap:8px;justify-content:space-between;margin-top:6px">
              <button class="btn-primary" id="btnRegister">ÄÄƒng kÃ½</button>
              <button class="btn-primary" id="btnLogin">ÄÄƒng nháº­p</button>
            </div>
            <p id="authStatus" class="small"></p>
          </div>

          <div id="userArea" style="display:none;margin-top:10px;">
            <p class="small">ÄÃ£ Ä‘Äƒng nháº­p: <b id="userEmail"></b></p>
            <button id="btnLogout" style="background:#8b5cf6;color:white">ÄÄƒng xuáº¥t</button>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <h4>ğŸ“ ÄÄƒng thÃ´ng tin (cáº§n Ä‘Äƒng nháº­p)</h4>
          <div id="postForm" style="display:none">
            <input id="title" placeholder="TiÃªu Ä‘á» (vÃ­ dá»¥: Cáº§u Tam Ká»³ ngáº­p 0.7m)" />
            <textarea id="desc" rows="3" placeholder="MÃ´ táº£ ngáº¯n..."></textarea>

            <label class="small">Chá»n media (1 áº£nh hoáº·c 1 video)</label>
            <input id="mediaFile" type="file" accept="image/*,video/*" />

            <label class="small">Má»©c Ä‘á»™ lá»¥t</label>
            <select id="level">
              <option value="green">Xanh (An toÃ n)</option>
              <option value="yellow">VÃ ng (Cáº£nh bÃ¡o)</option>
              <option value="orange">Cam (Ngáº­p sÃ¢u)</option>
              <option value="red">Äá» (Nguy cáº¥p)</option>
            </select>

            <div style="margin-top:8px;display:flex;gap:8px">
              <button id="btnPost" class="btn-primary">ÄÄƒng thÃ´ng tin</button>
              <button id="btnClear" type="button">XÃ³a form</button>
            </div>
            <p id="postStatus" class="small"></p>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <h4>ğŸ“‹ Ghi chÃº</h4>
          <p class="small">BÃ i viáº¿t cÃ´ng khai â€” má»i ngÆ°á»i xem Ä‘Æ°á»£c. Admin cÃ³ thá»ƒ xÃ³a bÃ i khi cáº§n. Media tá»‘i Ä‘a ~50MB (storage rule máº·c Ä‘á»‹nh).</p>
        </div>
      </aside>
    </div>
  </div>

  <!-- SCRIPTS -->
  
0:12 / 0:19
Facebook
Facebook
Facebook
Facebook
Facebook
Facebook
Facebook
Facebook
Facebook
Facebook
Facebook
Lá»i má»i káº¿t báº¡n
NgÆ°á»i liÃªn há»‡
Äoáº¡n chat cá»™ng Ä‘á»“ng
NhÃ³m chat
16:31
Ngá»c
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cá»©u Há»™ Miá»n Trung â€” Báº£n Ä‘á»“ há»— trá»£ cá»©u há»™</title>

  <!-- ThÆ° viá»‡n báº£n Ä‘á»“ miá»…n phÃ­ OpenStreetMap qua Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f4f4f4;
    }
    header {
      background: #0077b6;
      color: #fff;
      text-align: center;
      padding: 12px 0;
      font-size: 20px;
      font-weight: bold;
    }
    #map {
      height: 70vh;
      width: 100%;
    }
    .btn-container {
      text-align: center;
      margin: 10px;
    }
    button {
      background: #e63946;
      border: none;
      color: white;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #d62828;
    }
    .auth-box {
      text-align: center;
      margin: 20px auto;
      background: #fff;
      width: 300px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    input {
      width: 90%;
      padding: 8px;
      margin: 6px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    #status {
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <header>ğŸ†˜ Cá»¨U Há»˜ MIá»€N TRUNG â€” Báº¢N Äá»’ Há»– TRá»¢ KHáº¨N Cáº¤P</header>

  <div id="map"></div>
  <div class="btn-container">
    <button onclick="sendSOS()">ğŸš¨ Gá»­i tÃ­n hiá»‡u SOS</button>
  </div>

  <!-- Khung Ä‘Äƒng nháº­p -->
  <div class="auth-box">
    <h2>ÄÄƒng nháº­p hoáº·c Ä‘Äƒng kÃ½</h2>
    <input type="email" id="email" placeholder="Nháº­p email">
    <input type="password" id="password" placeholder="Nháº­p máº­t kháº©u">
    <br>
    <button id="signup">ÄÄƒng kÃ½</button>
    <button id="login">ÄÄƒng nháº­p</button>
    <p id="status"></p>
  </div>

  <script>
    // ========== Báº¢N Äá»’ LEAFLET ==========
    var map = L.map('map').setView([15.573, 108.474], 9);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    map.locate({setView: true, maxZoom: 15});
    map.on('locationfound', function(e) {
      var radius = e.accuracy / 2;
      L.marker(e.latlng).addTo(map).bindPopup("ğŸ“ Vá»‹ trÃ­ cá»§a báº¡n").openPopup();
      L.circle(e.latlng, radius).addTo(map);
    });
    map.on('locationerror', function() {
      alert("KhÃ´ng láº¥y Ä‘Æ°á»£c vá»‹ trÃ­ GPS â€” vui lÃ²ng báº­t Ä‘á»‹nh vá»‹!");
    });

    function sendSOS() {
      alert("ğŸš¨ TÃ­n hiá»‡u SOS Ä‘Ã£ Ä‘Æ°á»£c gá»­i!\nÄá»™i cá»©u há»™ sáº½ nháº­n vá»‹ trÃ­ cá»§a báº¡n.");
    }
  </script>

  <!-- ========== FIREBASE AUTH ========= -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyD6DNuThRLY6NsSqlhX71j5zHKhu6e-K_E",
      authDomain: "cuuho-mientrung.firebaseapp.com",
      projectId: "cuuho-mientrung",
      storageBucket: "cuuho-mientrung.firebasestorage.app",
      messagingSenderId: "54443732617",
      appId: "1:54443732617:web:e86f1bc8aea31e64a96058",
      measurementId: "G-4HRL9C2WX8"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const signupBtn = document.getElementById("signup");
    const loginBtn = document.getElementById("login");
    const status = document.getElementById("status");

    signupBtn.addEventListener("click", async () => {
      try {
        await createUserWithEmailAndPassword(auth, emailInput.value, passwordInput.value);
        status.textContent = "âœ… ÄÄƒng kÃ½ thÃ nh cÃ´ng!";
      } catch (err) {
        status.textContent = "âš ï¸ Lá»—i Ä‘Äƒng kÃ½: " + err.message;
      }
    });

    loginBtn.addEventListener("click", async () => {
      try {
        await signInWithEmailAndPassword(auth, emailInput.value, passwordInput.value);
        status.textContent = "âœ… ÄÄƒng nháº­p thÃ nh cÃ´ng!";
      } catch (err) {
        status.textContent = "âš ï¸ Lá»—i Ä‘Äƒng nháº­p: " + err.message;
      }
    });
  </script>

</body>
</html>
Ngá»c
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cá»©u há»™ Miá»n Trung</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f2f2f2; }
    h1 { color: #333; text-align: center; }
    .form-box { background: #fff; padding: 20px; border-radius: 8px; margin: 20px auto; width: 100%; max-width: 400px; }
    input, button, textarea { width: 100%; padding: 10px; margin: 8px 0; border-radius: 5px; border: 1px solid #ccc; }
    button { background: #007bff; color: white; cursor: pointer; }
    button:hover { background: #0056b3; }
    #posts { margin-top: 30px; }
    .post { background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
  </style>
</head>
<body>
  <h1>Cá»¨U Há»˜ MIá»€N TRUNG</h1>

  <div class="form-box" id="login-box">
    <h3>ÄÄƒng nháº­p / ÄÄƒng kÃ½</h3>
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Máº­t kháº©u">
    <button onclick="login()">ÄÄƒng nháº­p</button>
    <button onclick="register()">ÄÄƒng kÃ½</button>
  </div>

  <div class="form-box" id="post-box" style="display:none;">
    <h3>Xin chÃ o <span id="user-email"></span></h3>
    <textarea id="content" placeholder="Nháº­p ná»™i dung cáº­p nháº­t..."></textarea>
    <button onclick="postMessage()">ÄÄƒng thÃ´ng tin</button>
    <button onclick="logout()">ÄÄƒng xuáº¥t</button>
  </div>

  <div id="posts"></div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyD6DNuThRLY6NsSqlhX71j5zHKhu6e-K_E",
      authDomain: "cuuho-mientrung.firebaseapp.com",
      projectId: "cuuho-mientrung",
      storageBucket: "cuuho-mientrung.firebasestorage.app",
      messagingSenderId: "54443732617",
      appId: "1:54443732617:web:e86f1bc8aea31e64a96058",
      measurementId: "G-4HRL9C2WX8"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Email admin cá»‘ Ä‘á»‹nh
    const ADMIN_EMAIL = "admin@gmail.com";

    // ÄÄƒng kÃ½
    async function register() {
      const email = emailInput.value;
      const password = passwordInput.value;
      try {
        await createUserWithEmailAndPassword(auth, email, password);
        alert("ÄÄƒng kÃ½ thÃ nh cÃ´ng!");
      } catch (e) {
        alert(e.message);
      }
    }

    // ÄÄƒng nháº­p
    async function login() {
      const email = emailInput.value;
      const password = passwordInput.value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
        alert("ÄÄƒng nháº­p thÃ nh cÃ´ng!");
      } catch (e) {
        alert("Sai tÃ i khoáº£n hoáº·c máº­t kháº©u!");
      }
    }

    // ÄÄƒng xuáº¥t
    async function logout() {
      await signOut(auth);
    }

    // Khi tráº¡ng thÃ¡i Ä‘Äƒng nháº­p thay Ä‘á»•i
    onAuthStateChanged(auth, (user) => {
      if (user) {
        loginBox.style.display = "none";
        postBox.style.display = "block";
        userEmail.textContent = user.email;
        loadPosts();
      } else {
        loginBox.style.display = "block";
        postBox.style.display = "none";
      }
    });

    // ÄÄƒng bÃ i
    async function postMessage() {
      const user = auth.currentUser;
      if (!user) return alert("Báº¡n chÆ°a Ä‘Äƒng nháº­p!");
      const text = document.getElementById("content").value;
      if (text.trim() === "") return alert("Ná»™i dung trá»‘ng!");
      try {
        await addDoc(collection(db, "posts"), {
          email: user.email,
          content: text,
          time: serverTimestamp()
        });
        document.getElementById("content").value = "";
        alert("ÄÃ£ Ä‘Äƒng!");
        loadPosts();
      } catch (e) {
        alert("Lá»—i khi Ä‘Äƒng: " + e.message);
      }
    }

    // Hiá»ƒn thá»‹ bÃ i viáº¿t
    async function loadPosts() {
      const q = query(collection(db, "posts"), orderBy("time", "desc"));
      const querySnapshot = await getDocs(q);
      const postsDiv = document.getElementById("posts");
      postsDiv.innerHTML = "";
      querySnapshot.forEach((doc) => {
        const post = doc.data();
        const div = document.createElement("div");
        div.className = "post";
        div.innerHTML = <b>${post.email}</b><br>${post.content};
        postsDiv.appendChild(div);
      });
    }

    // Biáº¿n DOM nhanh
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const loginBox = document.getElementById("login-box");
    const postBox = document.getElementById("post-box");
    const userEmail = document.getElementById("user-email");
  </script>
</body>
</html>
Ngá»c
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cá»©u Há»™ Miá»n Trung</title>

  <!-- ThÆ° viá»‡n báº£n Ä‘á»“ miá»…n phÃ­ Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }
    header {
      background: #0077b6;
      color: #fff;
      text-align: center;
      padding: 12px;
      font-size: 20px;
      font-weight: bold;
    }
    #map {
      height: 70vh;
      width: 100%;
    }
    .form-container {
      text-align: center;
      padding: 10px;
      background: #fff;
    }
    input {
      padding: 8px;
      margin: 5px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      background: #0077b6;
      border: none;
      color: white;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #005f87;
    }
    #status {
      color: #222;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <header>ğŸ†˜ Cá»¨U Há»˜ MIá»€N TRUNG</header>

  <div id="map"></div>

  <div class="form-container">
    <h3>ÄÄƒng kÃ½ / ÄÄƒng nháº­p</h3>
    <input type="email" id="email" placeholder="Nháº­p email" />
    <input type="password" id="password" placeholder="Nháº­p máº­t kháº©u" />
    <br />
    <button id="signup">ÄÄƒng kÃ½</button>
    <button id="login">ÄÄƒng nháº­p</button>
    <p id="status"></p>
  </div>

  <!-- Firebase vÃ  logic xá»­ lÃ½ -->
  <script type="module">
    // Import Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

    // Cáº¥u hÃ¬nh Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyD6DNuThRLY6NsSqlhX71j5zHKhu6e-K_E",
      authDomain: "cuuho-mientrung.firebaseapp.com",
      projectId: "cuuho-mientrung",
      storageBucket: "cuuho-mientrung.firebasestorage.app",
      messagingSenderId: "54443732617",
      appId: "1:54443732617:web:e86f1bc8aea31e64a96058"
    };

    // Khá»Ÿi táº¡o Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // --- Hiá»ƒn thá»‹ báº£n Ä‘á»“ ---
    const map = L.map('map').setView([15.573, 108.474], 9);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Láº¥y vá»‹ trÃ­ GPS
    map.locate({ setView: true, maxZoom: 14 });
    map.on('locationfound', function(e) {
      L.marker(e.latlng).addTo(map).bindPopup("ğŸ“ Vá»‹ trÃ­ cá»§a báº¡n").openPopup();
    });
    map.on('locationerror', function() {
      alert("âš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c vá»‹ trÃ­ â€” báº­t GPS nhÃ©!");
    });

    // --- Xá»­ lÃ½ Ä‘Äƒng kÃ½ / Ä‘Äƒng nháº­p ---
    const email = document.getElementById("email");
    const password = document.getElementById("password");
    const status = document.getElementById("status");

    document.getElementById("signup").addEventListener("click", async () => {
      try {
        await createUserWithEmailAndPassword(auth, email.value, password.value);
        status.textContent = "âœ… ÄÄƒng kÃ½ thÃ nh cÃ´ng!";
      } catch (err) {
        status.textContent = "âŒ Lá»—i: " + err.message;
        console.error(err);
      }
    });

    document.getElementById("login").addEventListener("click", async () => {
      try {
        await signInWithEmailAndPassword(auth, email.value, password.value);
        status.textContent = "âœ… ÄÄƒng nháº­p thÃ nh cÃ´ng!";
      } catch (err) {
        status.textContent = "âŒ Lá»—i: " + err.message;
        console.error(err);
      }
    });
  </script>
</body>
</html>
Ngá»c
<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cá»©u Há»™ Miá»n Trung â€” Cáº­p nháº­t tÃ¬nh hÃ¬nh</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    :root{
      --blue:#0b74de;--danger:#d32f2f;--orange:#f97316;--yellow:#f59e0b;--green:#16a34a;
      --card:#fff;--muted:#5b6b72;
    }
    body{font-family:Arial,Helvetica,sans-serif;background:#eef6fb;margin:0;color:#06202a}
    header{background:linear-gradient(90deg,#084b58,#0b7a8b);color:white;padding:18px;text-align:center;font-size:20px}
    .wrap{max-width:1000px;margin:18px auto;padding:12px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
    @media (max-width:960px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border-radius:10px;padding:12px;box-shadow:0 6px 20px rgba(6,32,38,0.06)}
    .small{font-size:13px;color:var(--muted)}
    #map{height:300px;border-radius:8px;overflow:hidden;background:#dff3fa;display:flex;align-items:center;justify-content:center}
    input,select,textarea{width:100%;padding:10px;margin:6px 0;border-radius:8px;border:1px solid #d1e9f0}
    button{padding:10px 12px;border-radius:8px;border:0;cursor:pointer}
    .btn-primary{background:var(--blue);color:white}
    .btn-danger{background:var(--danger);color:white}
    .post{border-left:6px solid #eee;padding:10px;margin-bottom:10px;border-radius:6px;background:#fbffff}
    .badge{display:inline-block;padding:6px 8px;border-radius:6px;color:white;font-weight:600}
    .badge.red{background:var(--danger)} .badge.orange{background:var(--orange)} .badge.yellow{background:var(--yellow)} .badge.green{background:var(--green)}
    .admin-actions{margin-top:8px}
    .media{max-width:100%;border-radius:6px;margin-top:8px}
    .info-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  </style>
</head>
<body>
  <header>ğŸŒŠ Cá»¨U Há»˜ MIá»€N TRUNG â€” Cáº­p nháº­t & Cá»©u há»™</header>

  <div class="wrap">
    <div class="grid">
      <!-- LEFT: main -->
      <div>
        <div class="card">
          <h3>ğŸ“ Báº£n Ä‘á»“ (demo)</h3>
          <div id="map">Báº£n Ä‘á»“ sáº½ hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y</div>
          <p class="small">Báº£n Ä‘á»“ dÃ¹ng OpenStreetMap (Leaflet). Sau nÃ y cÃ³ thá»ƒ hiá»ƒn thá»‹ marker cÃ¡c bÃ i Ä‘Äƒng lÃªn map.</p>
        </div>

        <div class="card" style="margin-top:12px;">
          <h3>ğŸ“£ Báº£ng tin cá»™ng Ä‘á»“ng (cÃ´ng khai)</h3>
          <div id="postsList" class="small"></div>
        </div>
      </div>

      <!-- RIGHT: auth + post form -->
      <aside>
        <div class="card">
          <h4>ğŸ” ÄÄƒng kÃ½ / ÄÄƒng nháº­p</h4>
          <div id="authArea">
            <input id="email" type="email" placeholder="Email" />
            <input id="password" type="password" placeholder="Máº­t kháº©u (>=6 kÃ½ tá»±)" />
            <div style="display:flex;gap:8px;justify-content:space-between;margin-top:6px">
              <button class="btn-primary" id="btnRegister">ÄÄƒng kÃ½</button>
              <button class="btn-primary" id="btnLogin">ÄÄƒng nháº­p</button>
            </div>
            <p id="authStatus" class="small"></p>
          </div>

          <div id="userArea" style="display:none;margin-top:10px;">
            <p class="small">ÄÃ£ Ä‘Äƒng nháº­p: <b id="userEmail"></b></p>
            <button id="btnLogout" style="background:#8b5cf6;color:white">ÄÄƒng xuáº¥t</button>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <h4>ğŸ“ ÄÄƒng thÃ´ng tin (cáº§n Ä‘Äƒng nháº­p)</h4>
          <div id="postForm" style="display:none">
            <input id="title" placeholder="TiÃªu Ä‘á» (vÃ­ dá»¥: Cáº§u Tam Ká»³ ngáº­p 0.7m)" />
            <textarea id="desc" rows="3" placeholder="MÃ´ táº£ ngáº¯n..."></textarea>

            <label class="small">Chá»n media (1 áº£nh hoáº·c 1 video)</label>
            <input id="mediaFile" type="file" accept="image/*,video/*" />

            <label class="small">Má»©c Ä‘á»™ lá»¥t</label>
            <select id="level">
              <option value="green">Xanh (An toÃ n)</option>
              <option value="yellow">VÃ ng (Cáº£nh bÃ¡o)</option>
              <option value="orange">Cam (Ngáº­p sÃ¢u)</option>
              <option value="red">Äá» (Nguy cáº¥p)</option>
            </select>

            <div style="margin-top:8px;display:flex;gap:8px">
              <button id="btnPost" class="btn-primary">ÄÄƒng thÃ´ng tin</button>
              <button id="btnClear" type="button">XÃ³a form</button>
            </div>
            <p id="postStatus" class="small"></p>
          </div>
        </div>

        <div class="card" style="margin-top:12px;">
          <h4>ğŸ“‹ Ghi chÃº</h4>
          <p class="small">BÃ i viáº¿t cÃ´ng khai â€” má»i ngÆ°á»i xem Ä‘Æ°á»£c. Admin cÃ³ thá»ƒ xÃ³a bÃ i khi cáº§n. Media tá»‘i Ä‘a ~50MB (storage rule máº·c Ä‘á»‹nh).</p>
        </div>
      </aside>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script type="module">
    // ----- Imports (Firebase v11 modules) -----
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
    import { getStorage, ref as sRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-storage.js";

    // ----- Firebase config (em Ä‘Ã£ cung cáº¥p) -----
    const firebaseConfig = {
      apiKey: "AIzaSyD6DNuThRLY6NsSqlhX71j5zHKhu6e-K_E",
      authDomain: "cuuho-mientrung.firebaseapp.com",
      projectId: "cuuho-mientrung",
      storageBucket: "cuuho-mientrung.firebasestorage.app",
      messagingSenderId: "54443732617",
      appId: "1:54443732617:web:e86f1bc8aea31e64a96058",
      measurementId: "G-4HRL9C2WX8"
    };

    // ----- Init -----
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    // ----- Admin list (CÃ¡ch A) -----
    const adminEmails = ["admin@gmail.com", "cuuhoadmin@gmail.com"]; // chá»‰nh email admin á»Ÿ Ä‘Ã¢y

    // ----- DOM refs -----
    const emailEl = document.getElementById("email");
    const passEl = document.getElementById("password");
    const btnRegister = document.getElementById("btnRegister");
    const btnLogin = document.getElementById("btnLogin");
    const authStatus = document.getElementById("authStatus");
    const userArea = document.getElementById("userArea");
    const userEmailEl = document.getElementById("userEmail");
    const btnLogout = document.getElementById("btnLogout");

    const postForm = document.getElementById("postForm");
    const titleEl = document.getElementById("title");
    const descEl = document.getElementById("desc");
    const mediaEl = document.getElementById("mediaFile");
    const levelEl = document.getElementById("level");
    const btnPost = document.getElementById("btnPost");
    const btnClear = document.getElementById("btnClear");
    const postStatus = document.getElementById("postStatus");

    const postsList = document.getElementById("postsList");

    // ----- Leaflet map init -----
    const Lmap = L.map('map').setView([15.573, 108.474], 9);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(Lmap);

    // ----- Auth actions -----
    btnRegister.addEventListener("click", async () => {
      authStatus.textContent = "Äang Ä‘Äƒng kÃ½...";
      try {
        await createUserWithEmailAndPassword(auth, emailEl.value, passEl.value);
        authStatus.textContent = "âœ… ÄÄƒng kÃ½ thÃ nh cÃ´ng!";
      } catch (e) {
        authStatus.textContent = "âš ï¸ " + e.message;
        console.error(e);
      }
    });

    btnLogin.addEventListener("click", async () => {
      authStatus.textContent = "Äang Ä‘Äƒng nháº­p...";
      try {
        await signInWithEmailAndPassword(auth, emailEl.value, passEl.value);
        authStatus.textContent = "âœ… ÄÄƒng nháº­p thÃ nh cÃ´ng!";
      } catch (e) {
        authStatus.textContent = "âš ï¸ " + e.message;
        console.error(e);
      }
    });

    btnLogout.addEventListener("click", async () => {
      await signOut(auth);
    });

    // Track auth state
    let currentUser = null;
    onAuthStateChanged(auth, (user) => {
      currentUser = user;
      if (user) {
        userArea.style.display = "block";
        document.getElementById("authArea").style.display = "none";
        userEmailEl.textContent = user.email;
        postForm.style.display = "block";
      } else {
        userArea.style.display = "none";
        document.getElementById("authArea").style.display = "block";
        userEmailEl.textContent = "";
        postForm.style.display = "none";
      }
    });

    // ----- Post logic -----
    btnPost.addEventListener("click", async () => {
      if (!currentUser) return alert("Vui lÃ²ng Ä‘Äƒng nháº­p trÆ°á»›c khi Ä‘Äƒng bÃ i.");
      const title = titleEl.value.trim();
      const desc = descEl.value.trim();
      const level = levelEl.value;
      const file = mediaEl.files[0];

      if (!title || !desc) return alert("Vui lÃ²ng Ä‘iá»n tiÃªu Ä‘á» vÃ  mÃ´ táº£.");
      if (!file) return alert("Vui lÃ²ng chá»n 1 áº£nh hoáº·c 1 video.");

      postStatus.textContent = "Äang táº£i media lÃªn...";

      // upload file lÃªn Storage
      try {
        const timeNow = Date.now();
        const ext = file.name.split(".").pop();
        const storagePath = posts/${currentUser.uid}_${timeNow}.${ext};
        const storageRef = sRef(storage, storagePath);
        await uploadBytes(storageRef, file);
        const url = await getDownloadURL(storageRef);

        // lÆ°u doc vÃ o Firestore
        await addDoc(collection(db, "posts"), {
          uid: currentUser.uid,
          email: currentUser.email,
          title,
          description: desc,
          mediaUrl: url,
          mediaType: file.type.startsWith("image/") ? "image" : "video",
          floodLevel: level,
          createdAt: serverTimestamp()
        });

        postStatus.textContent = "âœ… ÄÄƒng thÃ nh cÃ´ng!";
        titleEl.value = ""; descEl.value = ""; mediaEl.value = ""; levelEl.value = "green";
      } catch (e) {
        console.error(e);
        postStatus.textContent = "âš ï¸ Lá»—i: " + e.message;
      }
    });

    btnClear.addEventListener("click", () => {
      titleEl.value = ""; descEl.value = ""; mediaEl.value = ""; levelEl.value = "green"; postStatus.textContent = "";
    });

    // ----- Real-time load posts (public) -----
    const postsQuery = query(collection(db, "posts"), orderBy("createdAt", "desc"));
    onSnapshot(postsQuery, (snapshot) => {
      postsList.innerHTML = "";
      snapshot.forEach(docSnap => {
        const data = docSnap.data();
        const id = docSnap.id;
        const div = document.createElement("div");
        div.className = "post";
        const timeStr = data.createdAt && data.createdAt.toDate ? data.createdAt.toDate().toLocaleString() : "";

        // flood level badge
        let badgeClass = "green", badgeLabel = "Xanh";
        if (data.floodLevel === "red") { badgeClass = "red"; badgeLabel = "Äá»"; }
        else if (data.floodLevel === "orange") { badgeClass = "orange"; badgeLabel = "Cam"; }
        else if (data.floodLevel === "yellow") { badgeClass = "yellow"; badgeLabel = "VÃ ng"; }

        // media HTML
        let mediaHtml = "";
        if (data.mediaUrl) {
          if (data.mediaType && data.mediaType.startsWith("image")) {
            mediaHtml = <img src="${data.mediaUrl}" class="media" alt="image"/>;
          } else {
            mediaHtml = <video src="${data.mediaUrl}" class="media" controls></video>;
          }
        }

        div.innerHTML = `
          <div class="info-row"><span class="badge ${badgeClass}">${badgeLabel}</span>
            <strong style="margin-left:8px">${escapeHtml(data.title)}</strong>
            <span style="margin-left:auto;color:#7b8b90;font-size:12px">${timeStr}</span>
          </div>
          <div style="margin-top:8px;color:#153e45">${escapeHtml(data.description)}</div>
          ${mediaHtml}
          <div class="admin-actions"></div>
          <div style="margin-top:8px;font-size:13px;color:#6b7780">NgÆ°á»i Ä‘Äƒng: ${escapeHtml(data.email)}</div>
        `;

        // Admin actions
        const adminActions = div.querySelector(".admin-actions");
        if (currentUser && adminEmails.includes(currentUser.email)) {
          const delBtn = document.createElement("button");
          delBtn.textContent = "XÃ³a bÃ i";
          delBtn.className = "btn-danger";
          delBtn.style.marginTop = "8px";
          delBtn.addEventListener("click", async () => {
            if (!confirm("XÃ¡c nháº­n xÃ³a bÃ i nÃ y?")) return;
            try {
              await deleteDoc(doc(db, "posts", id));
              alert("ÄÃ£ xÃ³a.");
            } catch (e) {
              console.error(e);
              alert("Lá»—i xÃ³a: " + e.message);
            }
          });
          adminActions.appendChild(delBtn);
        }

        postsList.appendChild(div);
      });
    });

    // Utility to escape HTML
    function escapeHtml(text) {
      if (!text) return "";
      return text.replace(/[&<>"']/g, function(m){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]; });
    }

    // (Optional) Could add markers on the map when posts arrive (left as extension)
  </script>
</body>
</html>
Ngá»c
<script type="module">
  // ===========================
  // 1ï¸âƒ£ Import Firebase SDK
  // ===========================
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
  import { 
    getAuth, 
    createUserWithEmailAndPassword, 
    signInWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";
  import {
    getFirestore,
    collection,
    addDoc,
    getDocs,
    deleteDoc,
    doc,
    query,
    orderBy
  } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
  import {
    getStorage,
    ref,
    uploadBytes,
    getDownloadURL
  } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-storage.js";

  // ===========================
  // 2ï¸âƒ£ Cáº¥u hÃ¬nh Firebase
  // ===========================
  const firebaseConfig = {
    apiKey: "AIzaSyD6DNuThRLY6NsSqlhX71j5zHKhu6e-K_E",
    authDomain: "cuuho-mientrung.firebaseapp.com",
    projectId: "cuuho-mientrung",
    storageBucket: "cuuho-mientrung.firebasestorage.app",
    messagingSenderId: "54443732617",
    appId: "1:54443732617:web:e86f1bc8aea31e64a96058"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const storage = getStorage(app);

  // ===========================
  // 3ï¸âƒ£ Báº£n Ä‘á»“ Leaflet
  // ===========================
  const map = L.map('map').setView([15.573, 108.474], 9);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  let currentPosition = null;
  map.locate({ setView: true, maxZoom: 14 });
  map.on('locationfound', (e) => {
    currentPosition = e.latlng;
    L.marker(e.latlng).addTo(map).bindPopup("ğŸ“ Vá»‹ trÃ­ cá»§a báº¡n").openPopup();
  });

  // ===========================
  // 4ï¸âƒ£ TÃ i khoáº£n & ÄÄƒng nháº­p
  // ===========================
  const email = document.getElementById("email");
  const password = document.getElementById("password");
  const status = document.getElementById("status");

  document.getElementById("signup").addEventListener("click", async () => {
    try {
      await createUserWithEmailAndPassword(auth, email.value, password.value);
      status.textContent = "âœ… ÄÄƒng kÃ½ thÃ nh cÃ´ng!";
    } catch (err) {
      status.textContent = "âŒ Lá»—i: " + err.message;
    }
  });

  document.getElementById("login").addEventListener("click", async () => {
    try {
      await signInWithEmailAndPassword(auth, email.value, password.value);
      status.textContent = "âœ… ÄÄƒng nháº­p thÃ nh cÃ´ng!";
    } catch (err) {
      status.textContent = "âŒ Lá»—i: " + err.message;
    }
  });

  // ===========================
  // 5ï¸âƒ£ Form Ä‘Äƒng bÃ i
  // ===========================
  const formContainer = document.querySelector(".form-container");
  const postForm = document.createElement("div");
  postForm.innerHTML = `
    <h3>ğŸ—ºï¸ Gá»­i thÃ´ng tin lÅ© lá»¥t</h3>
    <input id="mucdo" placeholder="Má»©c Ä‘á»™ lÅ© (nháº¹, trung bÃ¬nh, náº·ng)" /><br>
    <input type="file" id="media" accept="image/*,video/*" /><br>
    <button id="post">ÄÄƒng bÃ i</button>
    <div id="postStatus"></div>
    <div id="posts"></div>
  `;
  formContainer.appendChild(postForm);

  const postStatus = document.getElementById("postStatus");
  const postsDiv = document.getElementById("posts");

  // ===========================
  // 6ï¸âƒ£ ÄÄƒng bÃ i
  // ===========================
  document.getElementById("post").addEventListener("click", async () => {
    const user = auth.currentUser;
    const file = document.getElementById("media").files[0];
    const mucdo = document.getElementById("mucdo").value.trim();

    if (!user) {
      postStatus.textContent = "âŒ Cáº§n Ä‘Äƒng nháº­p Ä‘á»ƒ Ä‘Äƒng bÃ i.";
      return;
    }
    if (!file) {
      postStatus.textContent = "âŒ Vui lÃ²ng chá»n hÃ¬nh áº£nh hoáº·c video.";
      return;
    }
    if (!currentPosition) {
      postStatus.textContent = "âš ï¸ ChÆ°a láº¥y Ä‘Æ°á»£c vá»‹ trÃ­.";
      return;
    }

    try {
      const fileRef = ref(storage, media/${Date.now()}_${file.name});
      await uploadBytes(fileRef, file);
      const url = await getDownloadURL(fileRef);

      await addDoc(collection(db, "posts"), {
        user: user.email,
        mucdo,
        url,
        type: file.type.startsWith("video") ? "video" : "image",
        lat: currentPosition.lat,
        lng: currentPosition.lng,
        created: new Date()
      });

      postStatus.textContent = "âœ… ÄÄƒng bÃ i thÃ nh cÃ´ng!";
      document.getElementById("mucdo").value = "";
      document.getElementById("media").value = "";
      loadPosts();
    } catch (err) {
      postStatus.textContent = "âŒ Lá»—i: " + err.message;
    }
  });

  // ===========================
  // 7ï¸âƒ£ Hiá»ƒn thá»‹ bÃ i viáº¿t
  // ===========================
  async function loadPosts() {
    postsDiv.innerHTML = "";
    const q = query(collection(db, "posts"), orderBy("created", "desc"));
    const snap = await getDocs(q);
    snap.forEach((docSnap) => {
      const data = docSnap.data();
      const div = document.createElement("div");
      div.style.border = "1px solid #ccc";
      div.style.margin = "8px";
      div.style.padding = "8px";
      div.style.borderRadius = "8px";
      div.style.background = "#fff";

      let mediaHtml = "";
      if (data.type === "image")
        mediaHtml = <img src="${data.url}" style="width:100%;border-radius:6px">;
      else
        mediaHtml = <video controls style="width:100%;border-radius:6px"><source src="${data.url}"></video>;

      const isAdmin = auth.currentUser?.email === "admin@gmail.com";

      div.innerHTML = `
        <b>${data.user}</b><br>
        <b>ğŸŒŠ Má»©c Ä‘á»™:</b> ${data.mucdo}<br>
        ${mediaHtml}
        ${isAdmin ? <button class="delete" data-id="${docSnap.id}">ğŸ—‘ï¸ XÃ³a</button> : ""}
      `;

      postsDiv.appendChild(div);

      L.marker([data.lat, data.lng])
        .addTo(map)
        .bindPopup(<b>${data.user}</b><br>${data.mucdo});
    });

    // Xá»­ lÃ½ nÃºt xÃ³a (chá»‰ admin)
    document.querySelectorAll(".delete").forEach(btn => {
      btn.addEventListener("click", async () => {
        if (confirm("XÃ³a bÃ i nÃ y?")) {
          await deleteDoc(doc(db, "posts", btn.dataset.id));
          loadPosts();
        }
      });
    });
  }

  // ===========================
  // 8ï¸âƒ£ Theo dÃµi tráº¡ng thÃ¡i Ä‘Äƒng nháº­p
  // ===========================
  onAuthStateChanged(auth, (user) => {
    if (user) {
      status.textContent =ğŸ‘‹ Xin chÃ o, ${user.email}`;
      loadPosts();
    } else {
      status.textContent = "ğŸ”’ ChÆ°a Ä‘Äƒng nháº­p";
      postsDiv.innerHTML = "";
    }
  });
</script>
</body>
</html>
